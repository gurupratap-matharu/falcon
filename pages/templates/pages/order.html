{% extends "layouts/base-sidebar.html" %}

{% load static %}

{% block title %}
    Order
{% endblock title %}

{% block breadcrumb %}
    Order
{% endblock breadcrumb %}

{% block page_title %}
    Passenger Details
{% endblock page_title %}

{% block content %}
    <div class="row">
        <div class="col-12 col-lg-8">
            <div class="card">
                <form action="{% url 'payments:home' %}">
                    <div class="card-header pb-0">
                        <h6>Passenger Details</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <label for="document_type">Document</label>
                                <select class="form-select form-select-lg" name="document_type" id="document_type" aria-label="Document Type" required>
                                    {% with "dni passport cedula le lc cuit nie rg rne cpf rut curp cnpj" as document_types %}
                                        {% for document in document_types.split %}
                                            <option value="{{ document }}" {% if passenger.document_type == document %}selected{% endif %}>
                                                {{ document|upper }}
                                            </option>
                                        {% endfor %}
                                    {% endwith %}
                                </select>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="document_number" class="form-control-label">Number</label>
                                    <div class="input-group input-group-lg">
                                        <span class="input-group-text z-index-0">üîç</span>
                                        <input class="form-control"
                                               type="text"
                                               name="document_number"
                                               id="document_number"
                                               value="{{ passenger.document_number }}"
                                               aria-label="Document Number"
                                               aria-describedby="Document Number"
                                               required/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label for="nationality" class="form-label">Nationality</label>
                                <select class="form-select form-select-lg" id="nationality" name="nationality" aria-label="Nationality">
                                    {% with "argentina chile brasil paraguay peru other" as nationalities %}
                                        {% for nationality in nationalities.split %}
                                            <option value="{{ nationality }}" {% if passenger.nationality == nationality %}selected{% endif %}>
                                                {{ nationality|title }}
                                            </option>
                                        {% endfor %}
                                    {% endwith %}
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <label class="form-label" for="first_name">First Name</label>
                                <div class="input-group input-group-lg">
                                    <input id="first_name"
                                           name="first_name"
                                           class="form-control"
                                           type="text"
                                           placeholder="Alec"
                                           value="{{ passenger.first_name }}"
                                           required="required"
                                           onfocus="focused(this)"
                                           onfocusout="defocused(this)"/>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" for="last_name">Last Name</label>
                                <div class="input-group input-group-lg">
                                    <input id="last_name"
                                           name="last_name"
                                           class="form-control"
                                           type="text"
                                           placeholder="Thompson"
                                           value="{{ passenger.last_name }}"
                                           required="required"
                                           onfocus="focused(this)"
                                           onfocusout="defocused(this)"/>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label" for="email">Email</label>
                                <div class="input-group input-group-lg">
                                    <input id="email"
                                           name="email"
                                           class="form-control"
                                           type="email"
                                           placeholder="example@email.com"
                                           value="{{ passenger.email }}"
                                           required="required"
                                           onfocus="focused(this)"
                                           onfocusout="defocused(this)"/>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-md-2">
                                <label for="gender" class="form-label">Gender</label>
                                <select class="form-select form-select-lg" id="gender" name="gender" required>
                                    <option value="">
                                        None
                                    </option>
                                    <option value="female" {% if passenger.gender == 'female' %}selected{% endif %}>
                                        Female
                                    </option>
                                    <option value="male" {% if passenger.gender == 'male' %}selected{% endif %}>
                                        Male
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label for="birth_day">Day</label>
                                <input class="form-control form-control-lg" type="number" name="birth_day" value={{ passenger.birth_day }} id="birth_day" min="1" max="31" />
                            </div>
                            <div class="col-md-2">
                                <label for="birth_month">Month</label>
                                <select class="form-select form-select-lg" id="birth_month" name="birth_month">
                                    {% with "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec" as months %}
                                        {% for month in months.split %}
                                            <option value="{{ month }}"{% if passenger.birth_month == month %}selected{% endif %}>
                                                {{ month }}
                                            </option>
                                        {% endfor %}
                                    {% endwith %}
                                </select>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="birth_year" class="form-control-label">Year</label>
                                    <input class="form-control form-control-lg" type="number" name="birth_year" value={{ passenger.birth_year }} id="birth_year" min="1922" max="2022" />
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="phone" class="form-control-label">Phone</label>
                                    <div class="input-group input-group-lg">
                                        <span class="input-group-text z-index-0">üìû</span>
                                        <input class="form-control"
                                               name="phone"
                                               type="tel"
                                               placeholder="54-11-5025-4191"
                                               value="{{ passenger.phone }}"
                                               id="phone"
                                               required/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="seat" class="form-control-label">Seat</label>
                                    <div class="input-group input-group-lg">
                                        <span class="input-group-text z-index-0">üí∫</span>
                                        <input class="form-control"
                                               type="text"
                                               name="seat"
                                               id="seat"
                                               data-bs-toggle="modal"
                                               data-bs-target="#seatSelectModal"
                                               value="{{ passenger.seat }}"
                                               aria-label="Seat Number"
                                               aria-describedby="Seat Number"
                                               required/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer d-flex justify-content-center">
                        <button class="btn btn-primary" type="submit">Proceed to Payment</button>
                    </div>
                </form>
            </div>
        </div>
        <div class="col-12 col-lg-4">
            <div class="card">
                <div class="card-header pb-0">
                    <h6>Order overview</h6>
                    <p class="text-sm">
                        <i class="fa fa-arrow-up text-success" aria-hidden="true"></i>
                        <span class="font-weight-bold">24%</span> savings
                    </p>
                </div>
                <div class="card-body p-3">
                    <div class="timeline timeline-one-side">
                        <div class="timeline-block mb-3">
                            <span class="timeline-step">
                                <i class="ni ni-square-pin text-success text-gradient"></i>
                            </span>
                            <div class="timeline-content">
                                <h6 class="text-dark text-sm font-weight-bold mb-0">From {{ request.session.q.origin|upper }}</h6>
                                <p class="text-secondary font-weight-bold text-xs mt-1 mb-0">{{ request.session.trip.departure|upper }}</p>
                            </div>
                        </div>
                        <div class="timeline-block mb-3">
                            <span class="timeline-step">
                                <i class="ni ni-pin-3 text-danger text-gradient"></i>
                            </span>
                            <div class="timeline-content">
                                <h6 class="text-dark text-sm font-weight-bold mb-0">To {{ request.session.q.destination|upper }}</h6>
                                <p class="text-secondary font-weight-bold text-xs mt-1 mb-0">{{ request.session.trip.arrival|upper }}</p>
                            </div>
                        </div>
                        <div class="timeline-block mb-3">
                            <span class="timeline-step">
                                <i class="ni ni-bus-front-12 text-info text-gradient"></i>
                            </span>
                            <div class="timeline-content">
                                <h6 class="text-dark text-sm font-weight-bold mb-0">Company</h6>
                                <p class="text-secondary font-weight-bold text-xs mt-1 mb-0">{{ request.session.trip.company }}</p>
                            </div>
                        </div>
                        <div class="timeline-block mb-3">
                            <span class="timeline-step">
                                <i class="ni ni-time-alarm text-warning text-gradient"></i>
                            </span>
                            <div class="timeline-content">
                                <h6 class="text-dark text-sm font-weight-bold mb-0">Duration</h6>
                                <p class="text-secondary font-weight-bold text-xs mt-1 mb-0">
                                    {{ request.session.trip.duration }} Hs
                                </p>
                            </div>
                        </div>
                        <div class="timeline-block mb-3">
                            <span class="timeline-step">
                                <i class="ni ni-single-02 text-primary text-gradient"></i>
                            </span>
                            <div class="timeline-content">
                                <h6 class="text-dark text-sm font-weight-bold mb-0">
                                    Passengers
                                </h6>
                                <p class="text-secondary font-weight-bold text-xs mt-1 mb-0">
                                    {{ request.session.q.num_of_passengers }} Adults
                                </p>
                            </div>
                        </div>
                        <div class="timeline-block mb-3">
                            <span class="timeline-step">
                                <i class="ni ni-money-coins text-primary text-dark"></i>
                            </span>
                            <div class="timeline-content">
                                <h6 class="text-dark text-sm font-weight-bold mb-0">
                                    Price
                                </h6>
                                <p class="text-secondary font-weight-bold text-xs mt-1 mb-0">
                                    ${{ request.session.trip.price }}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal -->
    <div class="modal fade"
         id="seatSelectModal"
         tabindex="-1"
         role="dialog"
         aria-labelledby="seatSelectModal"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="font-weight-bolder text-primary text-gradient">
                        Choose your Seat
                    </h3>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                    </button>
                </div>
                <div class="modal-body">
                    <div class="card card-plain">
                        <div class="card-body pb-3" id="seat-container">
                        </div>
                    </div>
                </div>
                <div class="modal-footer d-none" id="modal-footer">
                    <button type="button" class="btn bg-gradient-default" data-bs-dismiss="modal">
                        Cancel
                    </button>
                    <button type="button" class="btn bg-gradient-primary" data-bs-toggle="modal" id="seat-submit">
                        Confirm
                    </button>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

{% block js %}
    <script type="text/javascript" src="{% static 'assets/js/seats/seatchart.min.js' %}" defer></script>
    <script type="text/javascript" src="{% static 'assets/js/seats/seats.js' %}" defer></script>
{% endblock js %}
